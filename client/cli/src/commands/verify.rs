// This file is part of Substrate.

// Copyright (C) Parity Technologies (UK) Ltd.
// SPDX-License-Identifier: GPL-3.0-or-later WITH Classpath-exception-2.0

// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.

// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU General Public License for more details.

// You should have received a copy of the GNU General Public License
// along with this program. If not, see <https://www.gnu.org/licenses/>.

//! implementation of the `verify` subcommand

use crate::{error, params::MessageParams, utils, with_crypto_scheme, CryptoSchemeFlag};
use clap::Parser;
use sp_core::crypto::{ByteArray, Ss58Codec};
use std::io::BufRead;

/// The `verify` command
#[derive(Debug, Clone, Parser)]
#[command(
	name = "verify",
	about = "Verify a signature for a message, provided on STDIN, with a given (public or secret) key"
)]
pub struct VerifyCmd {
	/// Signature, hex-encoded.
	sig: String,

	/// The public or secret key URI.
	/// If the value is a file, the file content is used as URI.
	/// If not given, you will be prompted for the URI.
	uri: Option<String>,

	#[allow(missing_docs)]
	#[clap(flatten)]
	pub message_params: MessageParams,

	#[allow(missing_docs)]
	#[clap(flatten)]
	pub crypto_scheme: CryptoSchemeFlag,
}

impl VerifyCmd {
	/// Run the command
	pub fn run(&self) -> error::Result<()> {
		self.verify(|| std::io::stdin().lock())
	}

	/// Verify a signature for a message.
	///
	/// The message can either be provided as immediate argument via CLI or otherwise read from the
	/// reader created by `create_reader`. The reader will only be created in case that the message
	/// is not passed as immediate.
	pub(crate) fn verify<F, R>(&self, create_reader: F) -> error::Result<()>
	where
		R: BufRead,
		F: FnOnce() -> R,
	{
		let message = self.message_params.message_from(create_reader)?;
		let sig_data = array_bytes::hex2bytes(&self.sig)?;
		let uri = utils::read_uri(self.uri.as_ref())?;
		let uri = if let Some(uri) = uri.strip_prefix("0x") { uri } else { &uri };

		with_crypto_scheme!(self.crypto_scheme.scheme, verify(sig_data, message, uri))
	}
}

fn verify<Pair>(sig_data: Vec<u8>, message: Vec<u8>, uri: &str) -> error::Result<()>
where
	Pair: sp_core::Pair,
	Pair::Signature: for<'a> TryFrom<&'a [u8]>,
{
	let signature =
		Pair::Signature::try_from(&sig_data).map_err(|_| error::Error::SignatureFormatInvalid)?;

	let pubkey = if let Ok(pubkey_vec) = array_bytes::hex2bytes(uri) {
		Pair::Public::from_slice(pubkey_vec.as_slice())
			.map_err(|_| error::Error::KeyFormatInvalid)?
	} else {
		Pair::Public::from_string(uri)?
	};

	if Pair::verify(&signature, &message, &pubkey) {
		println!("Signature verifies correctly.");
	} else {
		return Err(error::Error::SignatureInvalid);
	}

	Ok(())
}

#[cfg(test)]
mod test {
	use super::*;

	const ALICE: &str = "0xf5977c8283546a63723bc31d2619124f11db4658643336741df81757d5ad3062c2cbea221c40f4c0e184277f4a42a977a842f30258be1032877c7bef6c5194808b80f35dc7f98d7ff9288ae4a4a912035e8221f40ae88af06ac513214f3ee9670fa30520a4f11c3ae67998b0317604762e52cf16c66249d2ad5b826a78b63fd998b6e59d211bc8e9c5bd571c25242a1d077cebf83cbeff5d370bdcb7a4b24229cb7e09c3d29c18d3febdc3016899a4b982866ef590e9100e0c840764f14c7047564155252bbe99eda2b75d1a4a3ce29b39271d556d70b1ed556ef596f1715232e2bad788c342cfc1da5a915c7d2e215ec6458ba0ce038aedc4c4927a5b4313040d95447e9d919c1e52e739ffeff623e689ff45adc8b9f2a5288f49c91ff373e3b9fd3484b6fc4487c25c7f7e7200000b31a23b8a40cdf5f0cfd15d85a4fea33463e96d459f565a697a835e0babd120d3c4c108baec954736eaad09d6cdaaecff235a7df84b47fe0d2c26ddeda002fd7a28161d307100d7503b7fe534e1bd135728ea3a9ee9869064a6a4c09ee23d9d73ffa78fe4ba0b463583394c9dd308f7eb2e08b693d440670b00bc08322f7a51e17a94da43181cbd74629d1d4bed10a62a0736f24c7c5610a8fe19299a4bb212e25157abc5c2bd5642d8851ee46ba99be7937573095031c9be58ffdc9ca0f6d2b9c695df17de41af6fe375f2bf2a617291dd59c88f185d1a5f39868269a78b31f545111449d4ed09120382c74c98d5064292e18c38de0e4eacdb72966ed1058c293ae0c7106d2367482110176019c6f49d0e5e344d47bc631a00d746b10c764397108d40c6f9f725e6ecf371c97bfb688728efcd66803ce20d62eeb16e7b754b9e70c154decc7eb4025a4217195ddd0d22ab60511f5c0940e5b56a8fce63d3fc886b5d6460f4c125ab4a19700943af69bc901dcf9c3aa65af7777a3edf600eb0abba8c0fc3482a92c3230d5f80d335dd6bab0d7b435bbbf71387afa44db08514f0b685b595a940bcc43c19bed397be4cc255301230343fc9218d29ce5907bc326a6ddf033ee4cb0a4b1799a5a7bb8e8316fc7bf688854161a05110a471f7dc97766cbb27f78e642a60ed2da38fa84223a73b1d4b0886e70e98b5406af83330d82b212b1445febdfe1f15be2808689e74fef53ffd1f37ed8b1a6dedfc6f7f66620fc9ab4259cf04c9c0a8b47fb57e670710e0ad6a03bcbc430f7e740f6e0901be2bb9b3e49440d54b47c2eb9b989de9d07e268051d6adb7476f00164f8abfa828d369b83172fc7c39bd06222e406071cb4ab9fd822cdc5afb838171527ae71df38f48a5d1f40001f746be5db3bddf1580896d45e26ec3826082a648bdd7e212e471a1718b6085b745348ce4c245e17c8d906ae25a66deea5f541d033a11ad0124c6b8c9e48657a93eeb4adfc6d2ec0feaf8fad2f2666088743332b7dd9dda92f138ebe655b812f4ad8015496bf8e693041812f8bdf0a6be0bbbd9146ba8cdc85ba3b7f24123cab9f8ab21a6c856ae2df3dc1a491eff1a88c9938141621a0b25643e797879eca1eb6b9bb911a87ed0aa2e0cbf26b89acea1193d36e9c904178c8d051c38ad7df7d5f2de7e9718d468c4680203d6bb133f371dc57aa3422178e34ea85a791628afbcc4b342bf933d882e5f3f658de5a29c36aeed5e5d0c4e98b4020c4d9ddc41048cb7a0934974dd422b822dbbeb59a6e32029002a0273d2d9a12e089c75067fb9bff0b4c1fbcc3a598b057d5e9c1c9dede1b5e8140b12eacd4173b9893b959e05fbab3ab102d74feac4ada14481606c94581c0f541982e0f388f0a4b1167c28b66445116d0e8ad170fae674b0014af462ec6796a6306aaef03ecac8e495844588ab1b5be233766c9d01cfb1cb23dc082ed18a0c925fdee24b52845dd33355f9783b8e33304f80c39a742696a8f5db800bf05596166f145d37e227e495afe41f50dc498ac402cc54a65d8014273917ddd40d40779d71f89fd23be9d091c37f70d251b3fc90e44258d694f185a6c2f05162f48019cedfae6a589a8ab0e5238a96a1aeafec3be957c34e60d8589c45a0f2d7e7a59570256918858af67231285ef75b1747ae1358bc9899925795ddafbf1a4b2bdd518e9b3febe0541944b45f201b764d89f78382628b3e7677f643509618099107139945fc257ed617baca0c3c5f3db176a22f587bb6afc555b2778c4d3e12ed3ce9c852a6e20eee52b8a268cf75c282510338a57c2ccdb2730a699a7409548c39997c7f7aaedbbaf1393b41e5e05928e2d602397fe3f74f500b47bb54d3f2f305076a3a559d9ffad126f9e1032f8cd2dcc63da8f89b7657ca8065d7a684ba2cf20bbc30bbc7904d3ef65a08be1a1dcc67257be4eb0c0f0e1edb435f604615302b3342d2a60fb66ff83891e0bffdad4ddac312062b7ea1d5a7cfb8def890d1f18b7c2c8f94f5cd606b2c4e0bd23d3b8a6ea1d662b02e0374a833c6d3c724d89ebc2f3ff9637e90292501731a4b84626f5e62fe09301831e4a7520f21f0bdb5b11a6ad0f6844d7e501a63ec1dad1e65f59e60fd60b30a11999b4ab426e26f39af650daa41d7b40e0f279966a54fbe8b1430e91f80c600e80453f2d651ecb14764f8ad16b8f7fcb5619e6cbc30762b9187e29f194e8c4bd312063b201f5a1e9f417db4050ae46608af4504ac21b8700a5a3c15ec5652e8530632e1e15f25964d8307e267e899645955bbe5a4b7ac5f27e3989197e1f65a2795ccdc27516ee98990aecaf9479030bb78cbe6aa6a4a989f7de73c9ef1d0d43f7b2b91b69e5f86840d2ddd0566e57746f428d8a8132a26b98480ff9909e5b6f72ef041d876e40f6eea3f72564d475ff95cd6a1b4c9e4fc89d0b98414b9c362dbba2af11ef7a586da473a2d5e6b578c55e76b61d7a6f164d86f9eef7a3cbfbcf4331d3f833feeeee00a0e1f5eb157f556fbbcfeb5a245324854a61a1657ca1b91e33ed07cdd06a49e478c790164bb8bd9c13ed2c0b599f65241d84babff190aad5111681dc2832109cf8657d3f9e9ee1cb5a3b2062ce33efd5ec441d2b8d0400fa2807688b5a2224fdd8b189720b0cd79ec870662acd62125d639390b14eb7de1e249bd64f3c6089d82cb9a57a43adef841ad85fe4cb9ba80ea036211112ca5b6a8c3553a91c9a102dcf947485683cb177888a8b99ac1751a6fb19a39ab2333f19986307a9362951a901e58d1f17c7c965a6f4d2faec7dd3669c08b6b23231dbcbc1abc0fec463290cf44841b2b67a4426b5d2a12849485bb600e82f71a262a8dabdaf6a2b9a7d36f9774241fbc414e3f17501db2e36c93aef0c615370a9d0d6d2385609c2fe2f4b64c86040c73ecb4dd37c0d3f269e80ba8300bc988dada49fbda487dd210a3b1e9079e648643060268bfe9e4d6f1dbef3ee7afee04b7b28baf5174206978660aff906ebcef0589b45557ea755a920215b8823e30dee48ab4d4edec8e6249c1cbbc512f4e2768a70f3c98631ab42c0ae856390f718560886be09541e653752785fde101a925967920b18a40b0ce7b4b41ac8f5aa66d10755777b176158032dd049d32bdf5024b31c54bb17f84554c5287fe08b9fdd414a8df4299c49f625b791723d2067a9146eacf823c93ea7a190b7efda1bfe93ac96dfeaed96071";
	const SIG1: &str = "0x4bf2114ce65eb3362c37efef7d6d58386de88c87b6ad747e864be43711b1ef094525420aa10a130b909b3a62fb3d12256247ed7efc2b3e4bc2d25f5624f1fb00fdc47f17f59c085d89bc161ad39c4c7be4ebbaf6a4bc806cda3f4fe5646fa802842587e69c7b55a442dae49b2e2106210780c5342e95e18f7fb86ee7a3221dd2edb27de9a4fa420dc2812ae888edb8db20664add44f9b70d5bda6b7855961a59280a25ccefdbc066b20a9d72a9d73f0501415f314be5fa5a866f8c4fd7d8d343634578ebdc865e9674f13e96d09369b96c34c4dcbf7756b2779efa57e80c3eb70ab334a066b4f4803a57fc9b04eac5a7684a021227c114f1a446d3cbbb8aa8962f7308460ac6440ec06175ba27ab039b8a7796acfa86e3a031ded77bef48ebb43ab88bb734ed83f42fc843182f981ee9ea051cff389746fff5c3fb0bc32454eded6c1dc656697255c2addfd37c0665c77047076960d39f979ed66ba007d6580b9ac8b72d8598856524eed22a8ea16a6221b2b4fac379f3593f7cdd1cad6cc30aa2de7f8496b3e678fa1de287d391df8ec7585fb3ee425ebf9bbee1ff8b1afe4fa04375e1f344e6545a032441841c934bb1891e9e564eae689f525dbe66ea66b9d71e652c9b388d7bf428c111e2f498fe3290bfddf321c584bb6bd6e444b71684b9d6b420a216d48354f29e53a32c7624b066ab2790a9d04c99d3bf5c7ee760196e8a65120b4bbb028d5f7ce26caf95f77d880a8bd10b4dfee9d37e167b6cd6900194d52415b63a2b8f1d3f68d230c0f70cf52da05e501266220ce3c78454ded77703c2ab601376cf9629807fbaaf8009c8e898a120902ec994313b228836ef6ec9e79ff142428167ecfe75434e6d796bb15614ad367711685f70c9470a4cadf13de84c44dfc6eed292936f954e6410608a534ad64f1f58e4cc39139b3e4cf8c137be83f36b0d998b7407ce9ceb1c6413a8e0bf363d8e9e53118a92a31bfdcd91a196745e4341e062250f966b842bcc9a8c1bac6fbf6bcf6e91da2677546b6de602d1d3d67102644bff0c06b8d31e281ee142a137f74981261f8555130fab95535c059e46256603537c14831a0e8642b886cdce5cb01520fed7203efecad02ab14746781e82dd2fbdde38622232ad3e01085169e0180a3b73fcf76b3948e5a091a2b0b107e8effd2338576914072d9ac0720768db7968f444fac676c3a6a27c4e9dbc909292c189d6cf3bf1c93ab253b35e8871840ccd16feabd0ff42edf5a0b18526b48a9aefd1668949d0619e52e62c6c6d594ed396acca0c016d01d54cea91f02551d60d8670ea6e39437832866de240f3a11df4fa378652b0b2f4b8065a0339b25f3e92f48e1f74c13285a2f706dcbb8ed05deb4baee7a22294d2321ccf0ee3723c76a26efab0a343ff9e5d3e2525cdd3b14c932ef4813bcddb0480aa92010d70567f9e9b885544e23ab0fcf7a4b4388a25f8621ab1822a713cb5620197d18e5c8e80ac86d198b0f0ab001d51e80ea383ed0d02d0270ded0e2e0f1ff1cec4083f544cabfbcd8149334239c79482ea3b75048866d6ece5550fd590bb55703b19b09192616cc7d5c992752f9a065f8c48fcabc5b9828c66c903232aa42782a115b7cdab5e7642f603a27a6ec67f5d4376f4d5f257c0d1e4be4ce87fd6461ecd0a79466aaa37a97610d47668103bfcce225bd74601bc60dfacd302b93d3816abf88c57d5cb8339ef460ea0a2ed61f0070693f191893790f7eb264b4a4a7a9bf4a3e20ce6eef6018dcca2aede311e62482f27adedeeab0fd687969cf079c65149f18a009483a11a304f8d4f10229737c1353fc22e83dea4f1a5c8d2869d7e8466b10278ac9ee260eafbfd58eda9daec55680ff426c4be4513d9e5ea0dbe70b2b03560b27a67e0a0cb52d58138e24d965444905c690f5366b9a39e178351cef53b954a6a9a2dfe4e92673fb56ecd7c548f9fc2a8f47ba22d3e3c5471ea33bcd014db0a5decbfef43223cd96d0d54e1acab9d729c2616e91bb73226d1c0b2c76ab203a266950c3d81dd78d8779bc7a47c2d1f5104ec0237e8096f7df4ef0327e4397b137f9fb4608c00cb56dae496389862114d0338b42db1ad008927f9bd385b08ae71962755111ac6e1a484e38dca0719c8e3126fc178dd256240417e78e815a7f26ed06cad922617dc26e3030331771df3eae385be971a096ebb77e776db65fefbe989ba98d7a5680924d3f974565620f157a0c44c88b436ebdb46c1d5834d78785cc191a39e319cb8688195fcc7238c24782ade02765b07eb7df4c3b03c3cd9e007f6038943e2d529bcb43e7433f7a6f8c502447f80b3ef599edf5d5a41a1d5da74dc088a8ae0aea94b074b6b51e0e6dffd4a86d51974fbdbeaf9b6a9c93de3f62669ee2b30966a2a4109d6cc893187886c688450e0172d53d465c50b342056099b2c65b6fc92eca225674b50f3925822dc4ed0bf712045288ab4bf68ed78bb096e1f26cf96f58095a51babb5e0f46cc8506f84196459913cac017285bad21870c24a2072db22b9ce75be5776fdb4a0eac8ec2873edd45d016567cc2e9fc304eae529dd1c8bad44b15030546668329a31dff162c02cfc76fc026bd6694004e9d02a589bf76c2135854ce11fc65ae9c2f7249403671d0c8bf665c7ee989bb9283a486f6c353b73799ba05d375a79bbd5a34a6055a83ff64f49fe9f5114065b38befcea283628b6cceb3424e99e601106cfb37e6d5f3814be84fea5f60a91000eca4496bfdbb4259e38612724910bdeef27c3f698a01139f7ddb5e57594ec57c840c8fdab43f692af9b4528886ba5ef75c23112d633f784587b51b2c0ac03a17354b497b44001aaf0f33de0742e5b12be1014669e125d439373e62e8c6770b497365209220bfe4356ff3016c38b8babc53424a5d9a54421920899ee12814d6f3f61a86655ccc21c908fd66eb6aef41b2bed3e7c86a7153bd4126792604fb272b19030933e0d587ed563c9427e873a0d5b370aabec6390cf6db27d07b19b9d3175d166c61865f7c05c8c3d7bf4109d7f816fba5109b3fd5fa6087c0532ce4c4de7c969e49ca1c96612291147ed7d73d1bdd0c8fbb3b21027a5965742bc38aa330fef03a902d9d18314f65ae9b31edc182438cec2d65f6c263a6987da56db31ff34cf7cd4b9efd2dca84fa3279ecd8c5b208d943c3268e185af89becd50de2621c699e86830118a87bc875d5b7375995c2a6c38db7ecffa74c823161213dc2d53e74cf07595e16a490459b7cdea5ecff2ceb9de49a21e4168fafc9166c7dc28aa55f46a144ff5016652fedea4066df7fa976a609fceda1b43d4f0ec7f25f372d50e753ef53d5c18594db58debb5f1c4eb14aac56ceafde0662e7fe1d24c53ae70ea66ea1427f9ff75d629da9a2629809642d34506f34d774d704ae07d25ce6f330e7f8868f8422ecb71846762892f2279d1a3c78bcb4eebd774fd3cddc8bf40e1163f71d7a70823b734c33feadb5998b1001e8f20d9a45ae275b7fbff72e3404ddd94478f862990632684982cedeb76bc61d7ccba69ff30c4acc6fee6d36c94ad52bc46c31cff772cdc20b448662886de6982bb48da22e4bbab90a19c8c1700b61bf31b29eed88b31f441cf514dd7c28e891b2e18130a4587ebc05966ceeb3d10c18c2eeff81b81ef93c87b3a9ff3a0943a6576782ba694a4fbf907f702e4db96262348824c8d866e14b9d985089b8b613b180d194df30903dee0ee58f02e110ec6c77a9356c0ee91bf49f7bf3854d0568e5bfbff91ddf6d53fe41d52b7dc527d55c2fefc382b6dd044e2bacd9697a4a1512559107e19bedc37af45887458d2365ee4ab2866ff836e76716746f26f90b71f30e173aca00998fdbdbe49cbd7bbe99d63ad83f2564d1231839b55ccd3cf945f9eabdd6b1abefe3a9b767c87ea94b696efc3a72eaad326bdc64de3a04bc54c2a85e12b0edbe704ed12857f9e8664dd7797b2e34c9a7338990b529fa44d70b17c751cfa2d4b4684330d07208724c2b983118319431726b8291f64d988296f3f8691ad5a8e8c6fa2bd32634504c84bf849b803d95720410c9a6c55185ecbe11edc64f766cc318da5bd9e02db461cd85ed95172decb92b013c66c01e781cae04a3ae57d4d78286a190609814a1dcb083977c0a7c133533b1ba00aeb66b6482d42796af7b0589ab01e83417f9059e9fc21d8f9f6a1f51ab9ebd8c5c164f5d9117a7902685acc37fadb57a9ae18a2a6b8d1e9f1f031816873372bf1e8f6b48609db8c47ed68204f0fc28b5fb100bd0680b1e2be37558e667378891a4f848a98dba224f2f1375a33925db17b555e77d0bb8e1a1874cb029170a9dcdf947cd8c6b74e6cafc8c63dc3529b9973b4e0ebbd0c721718160e201202994a0b61ff5aca17dfd1d79a4926375a5ff8f72b79ac0596a254ffbba9268b5b7693fdce6866043457245e1f65e607989d2e0a4606bb5238ee026e4204e44b8957ab5bda5f724c1d2ae75ddc0a1bafd425c9a3ad891b851009461936f24810964032273d5557953b1d0ac5f26fd2a3028af70905aafb98de82ae051381c5a5f4db7bd32c724540f0aae769d08681507c599539dbb0fb3de15b05fa412d3d074f584d806331409c9c76cb73a45b6a4daac3ce88b88f04759b199af613947f69c2ef290d4e5f0e28acf426ef7dfcb2ef9ba5be834abb2a7d214737d3424ea545f2106e56e935db77b864d051b2fc788bb158d17a10bf413c06c7c02396b6b1e79b81caebd06b354835be60c6f8e95e367c1fa8ead0a37a2c845b74ee574e2224ed871ace59e95d38b3c8682e63d5cbca60cf1aba348354f92d2f355a24355206a72b4a367231dc74c57f4de45498b914fa0ea143611f79ebe0a343697ba6afa462edf7c6eb8fe5c2cdf20ca4233234e749e393aed51044166e97e80f51ef9fd7cd16b2773edb41a419820f075dfaeb21a8165a1c7da8363a798f5f6f42526575f96120489e5d3e58e8022920adb818111d3c4b5a15fb93a5cc91cdd3c314b9ac417a1bf50a56a2b2aa50cac097d8c31e736a094c449b480dda7f10a1ecaf849f0a6fedf34f4e0292e025db8e4bce5847650437194cfb841d9cf24807fa1ff6ce86a9bc675b21dd564b8290ef7e3a147cf1d7656415213ef3aa77d9043258ba5436dbb7c68f31d07d856f7859ac73deb5fb276897694e7345a0398924c49a14aca7c6d974b758ae1a9d2f6f1168a6cc21ac4154f74c5b2794ece5487aa36d74139df80c75bc58bcf651da61fcf656128e13f2d11a57249c6e9cb2de5cb248e425ad0d868bc138fab4c262bd95a2271f6aac34ff72454ca1d5fbb4ac347c15393761cadb8233d3a5fe45736222237de9824bfa3cbf3d2c5ea22568da0804da374b1c89f0f64acd46dd46fd53943bd4503aef4a184f32495b70753651c02424bb610e67faad9b063c9422bf3159258b7b5187a02ff27733ee6328d0edfbb8296935d686bf39dfcc15bb8eabc0c057e14ac05cf0c0dd6bb21633a0aad97021206628fb8d162043b7b5a3d4aea2c5ddb539601055268fb0a6cc7aa89f05315a92eb2ce26d04f7d416a4ceedd0bd70302b1e400563b2a69254987330f9c1cd70abea978618af1d02919a9bba5ee6f9a02ed557b1422882ca300a7ea6ca380f325f6f436b25425743c32ea1918bc2c82d8622019591b2739661f8fca1b0e4de73399e3b9f2ef420abfed8aaf52b13ced1e7282947d80b3cc07fbc92e02535af800952b07d121e081c816e4a1cf34c9fbaa1cda8ca3c0c9357a8f66c97c3fff473e96ab28244224926d941b6a87f48b17f609304f5d018fc6c65b3711d8f0346b5b5a57aa4ca0920a0ed2aecf1aeb3d2f08508c0a155d95ba7f33ed828de6234b64992971e957a458413158d28727d4750d87b0b37eb63f185e6542802142ceb81ad23a61b0d25c8a3afd81281f9d4e2a6ffc93b2fddfa264c554e748e80554ebc179bada778eae6927fe6d61346e0f755419e3978a24c9b3393299be81d04659334cca8c47da46fe2ccc430712586fcd1d27e8798879af998dacc9b5b2cb44d3b1fb743ea4d0d85c7254f531778e4c01f15a907dfe7ef2c96ec1bf7726ba8f6e09e5e06b5dddaa5990b9a8aff767ff57ef16f500147dda58d6820bbd9f0a3d452849b325276e4f2dce2725dfb541c28ec583c867478d06a2d86bb440e473b56263fed9d58c98e8d86410bfbc2128b915f25b4c81c4551224a7cd91c25a7cb38ef610717e07a803f73c3595a51fa0ce2dbe1b7552c50e3a1a8c1d15efe5d3615a9e1c4d81103542ad9255d380069700afe3b318510b9b8eea80b30bcb7fdceef188f083ea8eec3f715cfe4f5828b999cdc2a2bbc40f1633fd50fa9c1e9e334361c20958981df921afcfd6bc784b4538bccfdff1ff684f8bd91a7fc0703826811155161a5abd8dcec4b5f676b90b1ca1c3f626bebff7a818fccf4f91d1e5c5d7b7f89a3cfd318859ab8d0d5defa192b445ad8fd1848494c68899ab20000000000000000000000000000000910161c262e343cf5977c8283546a63723bc31d2619124f11db4658643336741df81757d5ad3062c2cbea221c40f4c0e184277f4a42a977a842f30258be1032877c7bef6c5194808b80f35dc7f98d7ff9288ae4a4a912035e8221f40ae88af06ac513214f3ee9670fa30520a4f11c3ae67998b0317604762e52cf16c66249d2ad5b826a78b63fd998b6e59d211bc8e9c5bd571c25242a1d077cebf83cbeff5d370bdcb7a4b24229cb7e09c3d29c18d3febdc3016899a4b982866ef590e9100e0c840764f14c7047564155252bbe99eda2b75d1a4a3ce29b39271d556d70b1ed556ef596f1715232e2bad788c342cfc1da5a915c7d2e215ec6458ba0ce038aedc4c4927a5b4313040d95447e9d919c1e52e739ffeff623e689ff45adc8b9f2a5288f49c91ff373e3b9fd3484b6fc4487c25c7f7e7200000b31a23b8a40cdf5f0cfd15d85a4fea33463e96d459f565a697a835e0babd120d3c4c108baec954736eaad09d6cdaaecff235a7df84b47fe0d2c26ddeda002fd7a28161d307100d7503b7fe534e1bd135728ea3a9ee9869064a6a4c09ee23d9d73ffa78fe4ba0b463583394c9dd308f7eb2e08b693d440670b00bc08322f7a51e17a94da43181cbd74629d1d4bed10a62a0736f24c7c5610a8fe19299a4bb212e25157abc5c2bd5642d8851ee46ba99be7937573095031c9be58ffdc9ca0f6d2b9c695df17de41af6fe375f2bf2a617291dd59c88f185d1a5f39868269a78b31f545111449d4ed09120382c74c98d5064292e18c38de0e4eacdb72966ed1058c293ae0c7106d2367482110176019c6f49d0e5e344d47bc631a00d746b10c764397108d40c6f9f725e6ecf371c97bfb688728efcd66803ce20d62eeb16e7b754b9e70c154decc7eb4025a4217195ddd0d22ab60511f5c0940e5b56a8fce63d3fc886b5d6460f4c125ab4a19700943af69bc901dcf9c3aa65af7777a3edf600eb0abba8c0fc3482a92c3230d5f80d335dd6bab0d7b435bbbf71387afa44db08514f0b685b595a940bcc43c19bed397be4cc255301230343fc9218d29ce5907bc326a6ddf033ee4cb0a4b1799a5a7bb8e8316fc7bf688854161a05110a471f7dc97766cbb27f78e642a60ed2da38fa84223a73b1d4b0886e70e98b5406af83330d82b212b1445febdfe1f15be2808689e74fef53ffd1f37ed8b1a6dedfc6f7f66620fc9ab4259cf04c9c0a8b47fb57e670710e0ad6a03bcbc430f7e740f6e0901be2bb9b3e49440d54b47c2eb9b989de9d07e268051d6adb7476f00164f8abfa828d369b83172fc7c39bd06222e406071cb4ab9fd822cdc5afb838171527ae71df38f48a5d1f40001f746be5db3bddf1580896d45e26ec3826082a648bdd7e212e471a1718b6085b745348ce4c245e17c8d906ae25a66deea5f541d033a11ad0124c6b8c9e48657a93eeb4adfc6d2ec0feaf8fad2f2666088743332b7dd9dda92f138ebe655b812f4ad8015496bf8e693041812f8bdf0a6be0bbbd9146ba8cdc85ba3b7f24123cab9f8ab21a6c856ae2df3dc1a491eff1a88c9938141621a0b25643e797879eca1eb6b9bb911a87ed0aa2e0cbf26b89acea1193d36e9c904178c8d051c38ad7df7d5f2de7e9718d468c4680203d6bb133f371dc57aa3422178e34ea85a791628afbcc4b342bf933d882e5f3f658de5a29c36aeed5e5d0c4e98b4020c4d9ddc41048cb7a0934974dd422b822dbbeb59a6e32029002a0273d2d9a12e089c75067fb9bff0b4c1fbcc3a598b057d5e9c1c9dede1b5e8140b12eacd4173b9893b959e05fbab3ab102d74feac4ada14481606c94581c0f541982e0f388f0a4b1167c28b66445116d0e8ad170fae674b0014af462ec6796a6306aaef03ecac8e495844588ab1b5be233766c9d01cfb1cb23dc082ed18a0c925fdee24b52845dd33355f9783b8e33304f80c39a742696a8f5db800bf05596166f145d37e227e495afe41f50dc498ac402cc54a65d8014273917ddd40d40779d71f89fd23be9d091c37f70d251b3fc90e44258d694f185a6c2f05162f48019cedfae6a589a8ab0e5238a96a1aeafec3be957c34e60d8589c45a0f2d7e7a59570256918858af67231285ef75b1747ae1358bc9899925795ddafbf1a4b2bdd518e9b3febe0541944b45f201b764d89f78382628b3e7677f643509618099107139945fc257ed617baca0c3c5f3db176a22f587bb6afc555b2778c4d3e12ed3ce9c852a6e20eee52b8a268cf75c282510338a57c2ccdb2730a699a7409548c39997c7f7aaedbbaf1393b41e5e05928e2d602397fe3f74f500b47bb54d3f2f305076a3a559d9ffad126f9e1032f8cd2dcc63da8f89b7657ca8065d7a684ba2cf20bbc30bbc7904d3ef65a08be1a1dcc67257be4eb0c0f0e1edb435f604615302b3342d2a60fb66ff83891e0bffdad4ddac312062b7ea1d5a7cfb8def890d1f18b7c2c8f94f5cd606b2c4e0bd23d3b8a6ea1d662b02e0374a833c6d3c724d89ebc2f3ff9637e90292501731a4b84626f5e62fe09301831e4a7520f21f0bdb5b11a6ad0f6844d7e501a63ec1dad1e65f59e60fd60b30a11999b4ab426e26f39af650daa41d7b40e0f279966a54fbe8b1430e91f80c600e80453f2d651ecb14764f8ad16b8f7fcb5619e6cbc30762b9187e29f194e8c4bd312063b201f5a1e9f417db4050ae46608af4504ac21b8700a5a3c15ec5652e8530632e1e15f25964d8307e267e899645955bbe5a4b7ac5f27e3989197e1f65a2795ccdc27516ee98990aecaf9479030bb78cbe6aa6a4a989f7de73c9ef1d0d43f7b2b91b69e5f86840d2ddd0566e57746f428d8a8132a26b98480ff9909e5b6f72ef041d876e40f6eea3f72564d475ff95cd6a1b4c9e4fc89d0b98414b9c362dbba2af11ef7a586da473a2d5e6b578c55e76b61d7a6f164d86f9eef7a3cbfbcf4331d3f833feeeee00a0e1f5eb157f556fbbcfeb5a245324854a61a1657ca1b91e33ed07cdd06a49e478c790164bb8bd9c13ed2c0b599f65241d84babff190aad5111681dc2832109cf8657d3f9e9ee1cb5a3b2062ce33efd5ec441d2b8d0400fa2807688b5a2224fdd8b189720b0cd79ec870662acd62125d639390b14eb7de1e249bd64f3c6089d82cb9a57a43adef841ad85fe4cb9ba80ea036211112ca5b6a8c3553a91c9a102dcf947485683cb177888a8b99ac1751a6fb19a39ab2333f19986307a9362951a901e58d1f17c7c965a6f4d2faec7dd3669c08b6b23231dbcbc1abc0fec463290cf44841b2b67a4426b5d2a12849485bb600e82f71a262a8dabdaf6a2b9a7d36f9774241fbc414e3f17501db2e36c93aef0c615370a9d0d6d2385609c2fe2f4b64c86040c73ecb4dd37c0d3f269e80ba8300bc988dada49fbda487dd210a3b1e9079e648643060268bfe9e4d6f1dbef3ee7afee04b7b28baf5174206978660aff906ebcef0589b45557ea755a920215b8823e30dee48ab4d4edec8e6249c1cbbc512f4e2768a70f3c98631ab42c0ae856390f718560886be09541e653752785fde101a925967920b18a40b0ce7b4b41ac8f5aa66d10755777b176158032dd049d32bdf5024b31c54bb17f84554c5287fe08b9fdd414a8df4299c49f625b791723d2067a9146eacf823c93ea7a190b7efda1bfe93ac96dfeaed96071";
	const SIG2: &str = "0xb768aeffdc5e1bef6af9b6fb1d3a22c6fbacccc4926f5eb9a766a130b3480d8325e15ad529a160fc20c4c761dcb76adcb77f9ee8d4b95ee8cc7896c01fc9029983dac69235e48143ddf95f39f6f1a10987995744e60bbd6e59f81839b75cd93b03d2ce1b9fcd569d02833e2c7a5503cb9c420e4039f646242521b49c969bda8bc937ebcf4202fb4baf544f2c973bfbd7d5da92f7fa95db86b3b8ae301852b525dc2927ca0c907309e0fc1cd09fbdb097dbfc846b5d1bb5ccf36ee2de8b738d9e7c86057125b1bb3a3faf77f17a7974f1374f5d9a76a6a5007be61bad70da304bf81ef0ba2a7cf2786998e278e96b9f1f8ef5d5b93b651b61f6498b56ba21bf15770d1e7bc18ba0b18e908a93978454e11d248411377451816abcdd96def47f7ccc12e43f73c7659a2928c4fed9b68d0afa574a796999fbdb413d2a0764819c0915e40361b9ec153e39eb3f754ba4d305d4cb3568c0031ed099a081827de803e5a0f6540d3054ecb3e1ea452f1926e865106af8ab8599afdf43bb9461f490354a6129a606b05db50b3d22c4aef82c8c02253066bc5a1357cb57d10a48d2e0f4e0cdf412b59ef60139e76e092a05089c64160deb1777903795a36a16946e2efbdfdbd1779b8f171900a8a2bac495ce8589860e9eabd76b3aa10202a0564a88c5cec514c54253bb8f3f76f040560fc9b5c0fb7772e18c59d6d4067e94f5e0fd71c5c42b1239703c6be9285af04fb90eb7ef4a2fcf02386127a26aec83d9ea3d1086f4460c662efb224befaa82fb2438162d846c607f63eb861c0a5b1544e0e54a10fea0af8743b3da207a29651ac3de1742c3938b395e258099904412107da020d37fde231f3b3d913144491ef110a51dc0e68dab02568d399e4806eac2bddc3739a38f3aba85fd755cd463fb0fb0dc461c1c598b88a3c6b00a5c3aaf2b2fc150f3217de5568d147969e2f5413ba1c3397279dfdb326d40796e66daf8c15077d482c6b9b60e7a72aadf071dfcce8a1c54077454516dc1625bbcef0628aced2028a004936af22a7cf6273a527b0659f28d39cbc46dfd80043d8352a77bd24fdf17b02845120234f2e476903c3d4691eeaddad14906ae08fd9795fa8c52c0b87e282eed3da52974d76f9118d5eb183d4d249cd5bdbc40ff222e34922168cd0d15b93150829c095ad4c44e82b84f2bc5ec780ec988b5abf2bd0dd0445713dc7236a8adfabf5ab1cab43b85908afc65ee428abf471b06899263e23e45dca319bbe05990adbddfab6e9cc3d4aa77067aab29c6e25bbb85b6472d83745afe12de122307ce9c79a770e38b35a423ab90605e5668f816bcfc852ad553fc25bea069416bce9d98702c06ee4c80b1f7ec0e46d28e98c93d4fafe59866ee7bc74eb1f87b18c28fc47216c98f8af4856d99c5d7c999dd14e299ec4b6338e8659a606fb825e4c7c7bb05342dd8f97f99bacb3e2e3790b18cc5fc37a7237fd2e8adec111c15a1d66972d0535c2b4dc9df9f8042d19253e869a4646e804fca53361c67dd931287ea2fbc5596b5ad4245af74f4b6f4364e381c05584736f82c3082104dcad91117169e9256cac2118720735dc379d5312e67858c245589e766d342896f6ea94b461c64ab3263dab0830918b2783b17b3d04a34e6ed590a60b425537b361932e6806bae209bf446d917bc2c39301f6e8ef02619206a6ce26c5057fe2e8f2a522397560478c4c16d3481d5fc633aa97425f2cf07594b177b52682dec4f6d044e9ef4e1d26de3e0f3711d3eb7f6d894511ca6b3f4c73ebb67035fdc32bff60250e596126902a031596925a32aeaacf300aaba9db4b6e7e089c158ac13e7011f5d1be1b070080be5d58591a33e5f8b1941399bf3ceaac5669ead2dcf439770045c214dae7261ef91136f3053c7bb7759b994946da97e2677676442cb7869a1052f9e55a5f140f65610f9e070084b322fa7c84c3f2f6599606b2430fcb5a5f8f856a5310f1727a1fd77cbfafb518405da55ec805e8ce4b19a3ed2fe6f006f78c919fde69d9128f374d5ea2763d8c86a427cc766a95e5211c160a9d58c8b31b95cb613597cf5ecae3567758b3eb8a220089772e5ea942743c8053583b5f5e558a8fc1f52e7c3ee324f2c3eb07560de8b3aa1d9da2371d6d1e071268dbfbc7e39e63540dc934ca684b2e194e74dcf457c30de4e394fc261126a034922f14ad8d3a5b05d9e20c13c1a14e76ffa83eeb7f0e9e78435e883c77ac37061231bd51081be15cf9497820cc248d24f4e7c5f8176a0c0e1b7892bbb64db1654609edf675963cbfe88e3f8b5c9f70d75303f6240b94d29586c35f4d756fadf8f28424603a92cf38e46166c8cb7dd4f863f8a63ab29a451288bdeccefb9d99b54f1cb82edde4967f3d4ea1a33e33919209e4cc1b75520b998224ccf70ec3867f669c289defef68aa4010d4ce7eaa86194b63c2cccce5bc3aac17e83b13a1527266c4c1b23513c474d4bd961f0d5db3a5846258958cf55beaf35ef74b6973e8aff38e05d9097ec85bc6a89c94674fdd24b8e86aed35f47d9a4e74d7711145ca4df2397fb1c01c01d2fb0d64fb260cc210450e77b388e9fe649e297250a0c5252d1ba30013227f82ca80a2452da509a44a0d3403946a51619efdb24cb7a0a016c5b1954c6bfae737225036deb55d4c1786621bc5561620ea067f7b1be951c4c385814f95164efeaad29a5c8066d3ab26c549b31dd4c625c77ae3be7830b772d77832553b3f0fc49028e753c4e6cd246296c88869f2b4e71b85a3f7eca44a92f75761c2f20cce689657ff2bc6a3b87c7ab85de70897a9692575e5503be71bc1728413efaf3fb0278ba8127f0e3b6db2d7972662c830617e9fdb7a842f2ad5a568bbb40ad21ea5697110e82f666b07b67f117b795504cee5b3f42fe28c8916bcf7d5d2b04d5a9532bac0e319e1314a7c0f6582972bb961afb697682e026cf50a4aab564deec303084457b276f6e686fc5a6636956d7560dde39bd27fba395086588fddd0d3d9c69ca3cb9320de06925aefb811ce0eb9f3dd667487bffc405cf92c3fa0d9417ea94e00f4240be4bf6800260558f3f0aad23b476cad67e883ed31f8d162ab80c8daf1bf0828b4c633679243a69bd9821682784d8134aee8c414bcb2b23fab357da59c1ed4fa67a55c18bf711df368e6a3b2f9896b79a41caf072edb02ad78d0fa341fc3ea181a0b86717e22c1a36f98a97f417258e7e2c68b539c5742fe4fb4cd0a3194c1f3e642c1db82dbc509a53544a57ae42189dd2abe67b773f46a1715a683bfd849ed07f7c8e01593f0540b9520d188fb1d267c7c0ab53d247525af22fa5e24059e27a339aca1d47d473af29d6525ef36a12ff85d5cce11fc7544397bb41e15d9c08d17a9cce92bb535a77ffbd3da51b7fe7d16fd320bde7684854c973196e335c13f01fb8c989a933ed5b8f21b4c77a61734049307a6bce7edbc333fe0868e9604ef0e555990271c7a517c7b4ebb42b0b4128df622f99755a889faa03b8cbdec91414137bd4e1960692a4591908facb4ad04961990dd75c810e6e2440612acac80f1e31cda9e44c85e1e1dd4819dac6feb079e152c5b7f6cca2b6e2b479ed2809b749873f2eecce827fad8cc88231527859b45ddd499b6e35e3df309f5f5dda9f6e0ef3c04963e72e970b9c0d517e3da4e2ebd6cd357d3bc0da3df8cd2eb457ef22db3498a7a740fe1119389d71684ad2402d13a4592cf214c46eddf15e81b2cff9b751dbbdbc39f3c351413748cb2815006f4604ad192f1bc1c5b70f683222212db164c3ad5f0d536cfdb0b314fb28373d3e98775c16edbb90b447e23ec3cd37a0cbda62ae7e60248e01e31e38c53385bd03c1d460d8cf72e22aedd22c5a26a55670fd8c27ab4aad987ed7038aa780607a9afd37cf79de25f0d7baca7eabdfb0c54a94f0d88b45e87a57270335883caa4b4d831dfce76186f872beffcae4b1f8a17efd43e537b57517b6ddf951ca2731675ef0b80bde39ff22d084d24072258dae8e8fc948bc95d7ef8c3f2ed6e31176b782d4704dcb0ea2e2eb5350c3ac6cdc3d81c67f19f857bf013e66a1c9ddd50c57e47ce2b517ddab9c25a41d9f1f47ebb0752f758cde24aef6f2a15d0e78e30047fd97cd5a862fb2f694d39d6695ea2d67a779b293974a7db42742afdbe5b3b7ea5d836540dd5f8a19b5d9618487cb2f908de501ac850167ed9faf31298af6f3f936166250c46484f4e14ca3e6b487dbc1484db4c0ac284398c7aa751c4b86b4b510744b8631bb2e7e95769825d9ed5a5f8c44c48e7cb1808f73dc90436a1eb04d6d9a0d5161cbf07f90a42ba3db5346cac15785888c1d4ee8e1a79ee5328bdb9334d4e6ea18a163de466ffd6e38f064a681f30ec65f08a50715960e442e57b88d8254efcacb4a69e4e75fc0b71ed977c731291d70600d08d52575e74e77c59c3041e65467f5c684a46ea71709ff3332ab3d1b339ffa3b6df5659f7e062228473a608879cfb33f41ca1f1fe8ae0b7279a82481fb1a44c5ab0b374af346582d8d0f622ce8b2116d2ff292e4a0b6f8265976d063169d07bd22c4e1e0a55f33b5502e5623e1a04710f04f3a1bcfae6e881146531605c4db204cf32e380532030dfc64abda52e33fd03a3850913ee86ff7318204461929bbd2f7df5a2a4545ad203e26e97c82fe933ea663b453397ea6648f24f8c14ea1c276952b6ed521a48e9716a80cd5d3f62b29b900c3a492e72d99b2ceda41a219e228f343d90c7b14e3a79bd86923313f034ecc90ecddc0e9baefc9b743aa91181a817e9c1481df6be6a4b1b725990aa9db8e3dad441950bd19eed253ff7422b35dce6823369e98923b4cd22e53f6c11a544a80d215a9009793a5f2ae027a28ca87012dc1f8a07f48d94c6dffd7b09a96ea9ef753df6a520f370e80da38613a8614230737cb99a10b973488f1c03364053f466a46c6502906a8938259c83c5ea3ab3229117c3831ed4562c7407cd43e0da536603dd8b5e920282fc5ffd3c2da2f5e8b9b27441e54d98d8cce5521fdecd9439f9117b7f7a1ed41a66c27595c3c2daad06b4d34e3fe33a1fe23594350ff062c390fdc3a32a0c73239dfbc1da7f9e887dbc42bc1caed583cc4e20a1e7d23ec75c9114540d90d55e39824e581547132ec3215682d152cf4982b34717ceb9b0b07f9143fdbb2fb90239c68074550d8bd8376ca5a182280503cd57a61f7386cee92e5efb7e8bf9d6e0f9089b71c62247e4cd0bc95a95b17a84f94a291be931f4799abdc3e4276da4f2c0f30d6e31d687e74d39ad0465dbb4d4c878476ce999b953cb1c14ed424f4b52978986841df98f47d87e9113133d2e2587bf693e715c74c9bbf1869099c8d58d6f9972fffc36d06017760a0d552b09b55d967437fc488fdddc0635a582327bc085dc3d669b39af7591c7fcdc6d86952f8b6779e991b493f561f84156a8c9976dea8005c05825e93abd12f44924d58fc7bd9171088256cd37647b07986702670c92bdef9ee8da43006782b3eec3881dfc546a0c6f9bfb2143884d8c7b27f00434ed30e0195edf887b257661afe05fddf823f9aba9a27a3e5b4a300f662989c12ac86269ec7117bc0a7f3de579fba2ff664e2a3251d65195d4123b44a6310ded7f35a7b3af3d678a87372112fe48383a59bb546c7494712b4dc7d2fd38d6fbd0984e56884be107739db49c7c16f31b6a3a2e26e4aab498e6bdc57ddbeb8a7951eb07f8b7782b36f2fb5cbc36e02b55f16aafabbab4c9808cd39791f548e35eaa2b1f1ca61d47466660c7780dbe842296328a8e4106fb7082f7b4e75e2b9799bc67730c3eda94ad796f672b8a6ca05eac5287aa5bad3d32bb89ad0ee8d509d3df3623863082fbeb9baf007fa8982b7043e014d232518fcb32dde44df0f8144b51061581f72096bed8cdfb04f683265484780527a9b74fc29bb9c0a061556cafc0a1b5e809e61b15649fcfaf9573104405f676e279ac384cf6eb78f9ee7b9d5f050cbed59eaf09d66e973ef3fa74538db94a5f2a27d91b30149e229e035b70c941b40a1362fa036e56b84f8c23232c87a500c57bec6d289c8627688fe0ec7692c9cdacb187d2e2f6b7f0eace654d615386e6ae86843c3f444ed8878c3c7a2d17cbd5d9f7c84eb44c703edba2ad1671e63a2bff74dd2c6358d99125fdbca4bcad4d0bd5e3089d089645b96a9ffb99adaa5b607231a270a3dbeb36c57ba3742edf5b8c209bb44fdd641bda2b3fd077c8a67aac58e2d77548fab2f1d4e11b3c0d739916c0b0c4b15d80df052c8207a641920255d9863dc2d5253194ef465e798725e0ccc352e84eadea32744af4f24724a09a102164328e805f0d51d89273329ac2093999fd40e05745b5770da4b00fa8b9b056e4840d1379d28b2b052493ea21f64b8e466dc169b12931b627b82d0ddf221286cd7e4273d44566c97c8f5fa2f5579f73a7fafd4e7254c88a7b4d0d2f30e1a6385a4aadce738436c74dee9fc00000000000000000000000000000000000000000000070c15191e262e35f5977c8283546a63723bc31d2619124f11db4658643336741df81757d5ad3062c2cbea221c40f4c0e184277f4a42a977a842f30258be1032877c7bef6c5194808b80f35dc7f98d7ff9288ae4a4a912035e8221f40ae88af06ac513214f3ee9670fa30520a4f11c3ae67998b0317604762e52cf16c66249d2ad5b826a78b63fd998b6e59d211bc8e9c5bd571c25242a1d077cebf83cbeff5d370bdcb7a4b24229cb7e09c3d29c18d3febdc3016899a4b982866ef590e9100e0c840764f14c7047564155252bbe99eda2b75d1a4a3ce29b39271d556d70b1ed556ef596f1715232e2bad788c342cfc1da5a915c7d2e215ec6458ba0ce038aedc4c4927a5b4313040d95447e9d919c1e52e739ffeff623e689ff45adc8b9f2a5288f49c91ff373e3b9fd3484b6fc4487c25c7f7e7200000b31a23b8a40cdf5f0cfd15d85a4fea33463e96d459f565a697a835e0babd120d3c4c108baec954736eaad09d6cdaaecff235a7df84b47fe0d2c26ddeda002fd7a28161d307100d7503b7fe534e1bd135728ea3a9ee9869064a6a4c09ee23d9d73ffa78fe4ba0b463583394c9dd308f7eb2e08b693d440670b00bc08322f7a51e17a94da43181cbd74629d1d4bed10a62a0736f24c7c5610a8fe19299a4bb212e25157abc5c2bd5642d8851ee46ba99be7937573095031c9be58ffdc9ca0f6d2b9c695df17de41af6fe375f2bf2a617291dd59c88f185d1a5f39868269a78b31f545111449d4ed09120382c74c98d5064292e18c38de0e4eacdb72966ed1058c293ae0c7106d2367482110176019c6f49d0e5e344d47bc631a00d746b10c764397108d40c6f9f725e6ecf371c97bfb688728efcd66803ce20d62eeb16e7b754b9e70c154decc7eb4025a4217195ddd0d22ab60511f5c0940e5b56a8fce63d3fc886b5d6460f4c125ab4a19700943af69bc901dcf9c3aa65af7777a3edf600eb0abba8c0fc3482a92c3230d5f80d335dd6bab0d7b435bbbf71387afa44db08514f0b685b595a940bcc43c19bed397be4cc255301230343fc9218d29ce5907bc326a6ddf033ee4cb0a4b1799a5a7bb8e8316fc7bf688854161a05110a471f7dc97766cbb27f78e642a60ed2da38fa84223a73b1d4b0886e70e98b5406af83330d82b212b1445febdfe1f15be2808689e74fef53ffd1f37ed8b1a6dedfc6f7f66620fc9ab4259cf04c9c0a8b47fb57e670710e0ad6a03bcbc430f7e740f6e0901be2bb9b3e49440d54b47c2eb9b989de9d07e268051d6adb7476f00164f8abfa828d369b83172fc7c39bd06222e406071cb4ab9fd822cdc5afb838171527ae71df38f48a5d1f40001f746be5db3bddf1580896d45e26ec3826082a648bdd7e212e471a1718b6085b745348ce4c245e17c8d906ae25a66deea5f541d033a11ad0124c6b8c9e48657a93eeb4adfc6d2ec0feaf8fad2f2666088743332b7dd9dda92f138ebe655b812f4ad8015496bf8e693041812f8bdf0a6be0bbbd9146ba8cdc85ba3b7f24123cab9f8ab21a6c856ae2df3dc1a491eff1a88c9938141621a0b25643e797879eca1eb6b9bb911a87ed0aa2e0cbf26b89acea1193d36e9c904178c8d051c38ad7df7d5f2de7e9718d468c4680203d6bb133f371dc57aa3422178e34ea85a791628afbcc4b342bf933d882e5f3f658de5a29c36aeed5e5d0c4e98b4020c4d9ddc41048cb7a0934974dd422b822dbbeb59a6e32029002a0273d2d9a12e089c75067fb9bff0b4c1fbcc3a598b057d5e9c1c9dede1b5e8140b12eacd4173b9893b959e05fbab3ab102d74feac4ada14481606c94581c0f541982e0f388f0a4b1167c28b66445116d0e8ad170fae674b0014af462ec6796a6306aaef03ecac8e495844588ab1b5be233766c9d01cfb1cb23dc082ed18a0c925fdee24b52845dd33355f9783b8e33304f80c39a742696a8f5db800bf05596166f145d37e227e495afe41f50dc498ac402cc54a65d8014273917ddd40d40779d71f89fd23be9d091c37f70d251b3fc90e44258d694f185a6c2f05162f48019cedfae6a589a8ab0e5238a96a1aeafec3be957c34e60d8589c45a0f2d7e7a59570256918858af67231285ef75b1747ae1358bc9899925795ddafbf1a4b2bdd518e9b3febe0541944b45f201b764d89f78382628b3e7677f643509618099107139945fc257ed617baca0c3c5f3db176a22f587bb6afc555b2778c4d3e12ed3ce9c852a6e20eee52b8a268cf75c282510338a57c2ccdb2730a699a7409548c39997c7f7aaedbbaf1393b41e5e05928e2d602397fe3f74f500b47bb54d3f2f305076a3a559d9ffad126f9e1032f8cd2dcc63da8f89b7657ca8065d7a684ba2cf20bbc30bbc7904d3ef65a08be1a1dcc67257be4eb0c0f0e1edb435f604615302b3342d2a60fb66ff83891e0bffdad4ddac312062b7ea1d5a7cfb8def890d1f18b7c2c8f94f5cd606b2c4e0bd23d3b8a6ea1d662b02e0374a833c6d3c724d89ebc2f3ff9637e90292501731a4b84626f5e62fe09301831e4a7520f21f0bdb5b11a6ad0f6844d7e501a63ec1dad1e65f59e60fd60b30a11999b4ab426e26f39af650daa41d7b40e0f279966a54fbe8b1430e91f80c600e80453f2d651ecb14764f8ad16b8f7fcb5619e6cbc30762b9187e29f194e8c4bd312063b201f5a1e9f417db4050ae46608af4504ac21b8700a5a3c15ec5652e8530632e1e15f25964d8307e267e899645955bbe5a4b7ac5f27e3989197e1f65a2795ccdc27516ee98990aecaf9479030bb78cbe6aa6a4a989f7de73c9ef1d0d43f7b2b91b69e5f86840d2ddd0566e57746f428d8a8132a26b98480ff9909e5b6f72ef041d876e40f6eea3f72564d475ff95cd6a1b4c9e4fc89d0b98414b9c362dbba2af11ef7a586da473a2d5e6b578c55e76b61d7a6f164d86f9eef7a3cbfbcf4331d3f833feeeee00a0e1f5eb157f556fbbcfeb5a245324854a61a1657ca1b91e33ed07cdd06a49e478c790164bb8bd9c13ed2c0b599f65241d84babff190aad5111681dc2832109cf8657d3f9e9ee1cb5a3b2062ce33efd5ec441d2b8d0400fa2807688b5a2224fdd8b189720b0cd79ec870662acd62125d639390b14eb7de1e249bd64f3c6089d82cb9a57a43adef841ad85fe4cb9ba80ea036211112ca5b6a8c3553a91c9a102dcf947485683cb177888a8b99ac1751a6fb19a39ab2333f19986307a9362951a901e58d1f17c7c965a6f4d2faec7dd3669c08b6b23231dbcbc1abc0fec463290cf44841b2b67a4426b5d2a12849485bb600e82f71a262a8dabdaf6a2b9a7d36f9774241fbc414e3f17501db2e36c93aef0c615370a9d0d6d2385609c2fe2f4b64c86040c73ecb4dd37c0d3f269e80ba8300bc988dada49fbda487dd210a3b1e9079e648643060268bfe9e4d6f1dbef3ee7afee04b7b28baf5174206978660aff906ebcef0589b45557ea755a920215b8823e30dee48ab4d4edec8e6249c1cbbc512f4e2768a70f3c98631ab42c0ae856390f718560886be09541e653752785fde101a925967920b18a40b0ce7b4b41ac8f5aa66d10755777b176158032dd049d32bdf5024b31c54bb17f84554c5287fe08b9fdd414a8df4299c49f625b791723d2067a9146eacf823c93ea7a190b7efda1bfe93ac96dfeaed96071";

	// Verify work with `--message` argument.
	#[test]
	fn verify_immediate() {
		let cmd = VerifyCmd::parse_from(&["verify", SIG1, ALICE, "--message", "test message"]);
		assert!(cmd.run().is_ok(), "Alice' signature should verify");
	}

	// Verify work without `--message` argument.
	#[test]
	fn verify_stdin() {
		let cmd = VerifyCmd::parse_from(&["verify", SIG1, ALICE]);
		let message = "test message";
		assert!(cmd.verify(|| message.as_bytes()).is_ok(), "Alice' signature should verify");
	}

	// Verify work with `--message` argument for hex message.
	#[test]
	fn verify_immediate_hex() {
		let cmd = VerifyCmd::parse_from(&[
			"verify",
			SIG2,
			ALICE,
			"--message",
			"0x48656c6c6f2c20776f726c6421",
			"--hex",
		]);
		assert!(cmd.run().is_ok(), "Alice' signature should verify");
	}

	// Verify work without `--message` argument for hex message.
	#[test]
	fn verify_stdin_hex() {
		let cmd = VerifyCmd::parse_from(&["verify", SIG2, ALICE, "--hex"]);
		assert!(cmd.verify(|| "0x48656c6c6f2c20776f726c6421".as_bytes()).is_ok());
		assert!(cmd.verify(|| "48656c6c6f2c20776f726c6421".as_bytes()).is_ok());
		let cmd = VerifyCmd::parse_from(&["verify", SIG1, ALICE, "--hex"]);
		assert!(cmd.verify(|| "0x74657374206d657373616765".as_bytes()).is_ok());
	}
}
